## 트러블슈팅 보고서: 위젯 포커스(Focus) 설정 불가 문제
### 프로젝트: 인벤토리 시스템 개발
### 발생일: 2025-08-16

#### 1. 문제 현상 (Symptom)
- 인벤토리 UI를 열 때 SetInputMode(FInputModeUIOnly)를 호출하는 과정에서, 다음과 같은 에러 로그가 출력되며 입력 모드가 제대로 전환되지 않았다.
- LogPlayerController: Error: InputMode:UIOnly - Attempting to focus Non-Focusable widget
- WBP_Inventory 위젯 블루프린트의 디테일 패널에서 'Is Focusable' 옵션을 활성화했음에도 불구하고, 런타임 시점에는 위젯이 여전히 포커스를 받을 수 없는 상태(Non-Focusable)로 인식되었다.

#### 2. 원인 분석 (Root Cause Analysis)
- 이 문제는 블루프린트 에디터에서 설정한 기본값이 실제 게임 실행 시점에 제대로 적용되지 않았기 때문에 발생했다.
- 몇 가지 가능성을 추론할 수 있다.

- 주요 원인: 블루프린트 기본값(Default Value)의 런타임 오버라이드(Override)
  - UUserWidget의 C++ 기본 생성자에서 bIsFocusable의 기본값이 false로 설정되어 있다.
  - 어떤 이유로든(엔진 버전, 프로젝트 설정 등) 블루프린트 에셋의 설정값보다 C++의 기본값이 우선 적용되어, 런타임에는 IsFocusable 속성이 false인 인스턴스가 생성되었다.

- 기타 가능성:
  - 캐릭터 블루프린트가 수정된 WBP_Inventory가 아닌, 다른 경로의 동일한 이름의 에셋이나 수정 전의 옛날 에셋을 참조하고 있었을 가능성.
  - 언리얼 에디터의 일시적인 캐시 문제로 블루프린트의 변경 사항이 제대로 반영되지 않았을 가능성.

#### 3. 해결 과정 (Resolution)
- 이 문제의 핵심은 "블루프린트 설정이 어떻든, 런타임에 생성된 위젯 인스턴스는 반드시 포커스가 가능해야 한다"는 것이다.
- 처음에는 블루프린트 설정에 의존하는 대신, C++ 코드 레벨에서 이 속성을 강제하는 방향으로 접근했었다.

1. UE 5.1 이전 방식 시도 (Deprecated): UInventoryWidget의 C++ 생성자에서 bIsFocusable = true; 코드를 추가하여 속성을 강제로 설정했다. 이 방법은 문제를 해결했지만, 'bIsFocusable에 직접 접근하는 것은 더 이상 사용되지 않는다'는 컴파일러 경고를 발생시켰다.
2. 최신 권장 방식 적용: 언리얼 엔진의 설계 변경을 존중하여 C++ 코드 수정을 철회했다. 대신, 근본적인 원인인 Blueprint 설정 문제를 해결하는 데 집중했다.
  - 캐릭터 블루프린트의 InventoryWidgetClass 변수에 할당된 에셋을 돋보기 아이콘으로 확인하여, 내가 수정한 바로 그 WBP_Inventory 에셋이 맞는지 검증했다.
  - WBP_Inventory의 'Is Focusable' 설정을 껐다가 다시 켜고, 블루프린트를 재컴파일하여 에디터에 변경 사항을 확실히 인지시켰다.
  - Binaries, DerivedDataCache, Intermediate 폴더들을 삭제하고 uproject를 Generate 했다.
- 결과적으로, C++ 코드 수정 없이 블루프린트의 설정을 다시 한번 명확히 적용하는 것만으로 문제가 해결되었다. 이는 C++ 코드와 블루프린트 에셋 간의 동기화가 일시적으로 깨졌던 것이 원인이었음을 시사한다.

#### 4. 교훈 및 예방 조치 (Lessons Learned & Prevention)
- 블루프린트에서 설정한 값이 런타임에 적용되지 않는 문제가 발생하면, C++ 코드로 강제하기 전에 먼저 **참조하는 에셋이 올바른지, 설정이 제대로 저장 및 컴파일되었는지부터 확인하는 것이 중요**하다.
- 디버깅 순서:
  - 에셋 검증: C++ 코드가 참조하는 블루프rint 에셋이 내가 수정한 파일이 맞는지 확인한다.
  - 설정 새로고침: 블루프린트 설정을 변경했다가 원복한 후 다시 컴파일하여 변경 사항을 강제로 적용한다.
  - 캐시 삭제: Binaries, DerivedDataCache, Intermediate 폴더 삭제 후 uproject를 Generate 한다.
  - C++ 오버라이드 (최후의 수단): 위 방법으로 해결되지 않을 경우, 생성자에서 C++ 코드로 속성을 직접 설정하는 것을 고려한다. (단, Deprecated 경고에 유의)
